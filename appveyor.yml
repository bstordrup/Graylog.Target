version: '{build}'
image: Ubuntu2004

# build platform, i.e. x86, x64, Any CPU. This setting is optional.
platform: Any CPU

# build Configuration, i.e. Debug, Release, etc.
configuration: Release

environment:
  BuildNumber: '%APPVEYOR_BUILD_NUMBER%'
  RepositoryBranch: '%APPVEYOR_REPO_BRANCH%'
  RepositoryCommit: '%APPVEYOR_REPO_COMMIT%'

build_script:
- cmd: dotnet build

test:
  assemblies:
    only:
    - tests/**/*.Tests.dll

after_test:
- cmd: dotnet pack -o ./packages

artifacts:
- path: packages/*.nupkg
  name: packages

deploy:
- provider: NuGet
  api_key:
    secure: kjhKEgtGi26pGBlQnvDdH1nv/Ijyf3+OvyqSUvwd5KjJsg7xLQ1iSeDemGRE6g1m
  skip_symbols: true
  artifact: packages
  on:
    branch: master